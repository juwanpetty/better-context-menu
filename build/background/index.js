import{g as u,T as m}from"../assets/storage-DX75RmAV.js";const d=["Navigation & Lifecycle","Content & Sharing","Tab State & Behavior","Window Management"];async function c(){const t=await u(),[e]=await chrome.tabs.query({active:!0,currentWindow:!0});chrome.contextMenus.removeAll(()=>{d.forEach((n,r)=>{const i=m.filter(o=>o.group===n&&t.includes(o.id));i.forEach(o=>{let a=o.label;o.id==="muteToggle"&&e?.mutedInfo&&(a=e.mutedInfo.muted?"Unmute tab":"Mute tab"),o.id==="pinToggle"&&(a=e?.pinned?"Unpin tab":"Pin tab"),chrome.contextMenus.create({id:o.id,title:a,contexts:["page"]})});const s=r===d.length-1;i.length&&!s&&chrome.contextMenus.create({id:`separator-${n}`,type:"separator",contexts:["page"]})})})}async function l(t,e){if(e?.id)switch(t){case"duplicate":chrome.tabs.duplicate(e.id);break;case"close":chrome.tabs.remove(e.id);break;case"reopenClosed":chrome.sessions.restore();break;case"copyUrl":e.id&&e.url&&chrome.scripting.executeScript({target:{tabId:e.id},func:n=>navigator.clipboard.writeText(n),args:[e.url]});break;case"bookmark":chrome.bookmarks.create({title:e.title,url:e.url});break;case"pinToggle":chrome.tabs.update(e.id,{pinned:!e.pinned});break;case"muteToggle":chrome.tabs.update(e.id,{muted:!e.mutedInfo?.muted});break;case"moveToWindow":chrome.windows.getAll({populate:!1},n=>{const r=n.find(i=>i.id!==e.windowId);r&&e.id&&(chrome.tabs.move(e.id,{windowId:r.id,index:-1}),chrome.windows.update(r.id,{focused:!0}))});break;default:console.warn(`Unknown tab action: ${t}`)}}chrome.runtime.onInstalled.addListener(()=>{c()});chrome.runtime.onStartup.addListener(()=>{c()});chrome.runtime.onMessage.addListener(t=>{t.type==="UPDATE_CONTEXT_MENU"&&c()});chrome.contextMenus.onClicked.addListener((t,e)=>{l(t.menuItemId,e)});
